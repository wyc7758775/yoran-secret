import{k as u,p as ee,z as K,A as te,e as se,d as B,C as re,_ as oe,i as ne,f as ae,D as le,a as ie,G as ce,H as ue,y as de}from"./BackToTop.CL0GF-jv.js";import{h as i,al as fe,d as D,at as ve,x as m,ar as pe,z as me,p as ge,c as g,o as f,r as y,e as h,j as M,t as we,k as a,n as N,G as V,M as W,b as ye,as as he,w as P,au as F,av as H,R as Se,aw as Ee}from"./framework.5RKWivQp.js";const Le=(r,o)=>{if(!u)return!1;const t={undefined:"overflow",true:"overflow-y",false:"overflow-x"}[String(o)],s=ee(r,t);return["scroll","auto","overlay"].some(l=>s.includes(l))},be=(r,o)=>{if(!u)return;let t=r;for(;t;){if([window,document,document.documentElement].includes(t))return window;if(Le(t,o))return t;t=t.parentNode}return t};let L;const xe=r=>{var o;if(!u)return 0;if(L!==void 0)return L;const t=document.createElement("div");t.className=`${r}-scrollbar__wrap`,t.style.visibility="hidden",t.style.width="100px",t.style.position="absolute",t.style.top="-9999px",document.body.appendChild(t);const s=t.offsetWidth;t.style.overflow="scroll";const l=document.createElement("div");l.style.width="100%",t.appendChild(l);const n=l.offsetWidth;return(o=t.parentNode)==null||o.removeChild(t),L=s-n,L},Ce=["class","style"],ke=/^on[A-Z]/,ze=(r={})=>{const{excludeListeners:o=!1,excludeKeys:t}=r,s=i(()=>(t?.value||[]).concat(Ce)),l=fe();return l?i(()=>{var n;return K(Object.entries((n=l.proxy)==null?void 0:n.$attrs).filter(([S])=>!s.value.includes(S)&&!(o&&ke.test(S))))}):i(()=>({}))},Ie=(r,o)=>{if(!u||!r||!o)return!1;const t=r.getBoundingClientRect();let s;return o instanceof Element?s=o.getBoundingClientRect():s={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},t.top<s.bottom&&t.bottom>s.top&&t.right>s.left&&t.left<s.right},Be=se({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:B([String,Object])},previewSrcList:{type:B(Array),default:()=>re([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},showProgress:Boolean,crossorigin:{type:B(String)}}),Ne={load:r=>r instanceof Event,error:r=>r instanceof Event,switch:r=>te(r),close:()=>!0,show:()=>!0},Pe=D({name:"ElImage",inheritAttrs:!1}),Ae=D({...Pe,props:Be,emits:Ne,setup(r,{expose:o,emit:t}){const s=r,{t:l}=ne(),n=ae("image"),S=ve(),A=i(()=>K(Object.entries(S).filter(([e])=>/^(data-|on[A-Z])/i.test(e)||["id","style"].includes(e)))),_=ze({excludeListeners:!0,excludeKeys:i(()=>Object.keys(A.value))}),b=m(),w=m(!1),v=m(!0),C=m(!1),E=m(),d=m(),G=u&&"loading"in HTMLImageElement.prototype;let k;const U=i(()=>[n.e("inner"),z.value&&n.e("preview"),v.value&&n.is("loading")]),X=i(()=>{const{fit:e}=s;return u&&e?{objectFit:e}:{}}),z=i(()=>{const{previewSrcList:e}=s;return pe(e)&&e.length>0}),Z=i(()=>{const{previewSrcList:e,initialIndex:c}=s;let p=c;return c>e.length-1&&(p=0),p}),$=i(()=>s.loading==="eager"?!1:!G&&s.loading==="lazy"||s.lazy),I=()=>{u&&(v.value=!0,w.value=!1,b.value=s.src)};function q(e){v.value=!1,w.value=!1,t("load",e)}function Y(e){v.value=!1,w.value=!0,t("error",e)}function R(){Ie(E.value,d.value)&&(I(),O())}const T=le(R,200,!0);async function x(){var e;if(!u)return;await Se();const{scrollContainer:c}=s;ce(c)?d.value=c:Ee(c)&&c!==""?d.value=(e=document.querySelector(c))!=null?e:void 0:E.value&&(d.value=be(E.value)),d.value&&(k=ue(d,"scroll",T),setTimeout(()=>R(),100))}function O(){!u||!d.value||!T||(k?.(),d.value=void 0)}function j(){z.value&&(C.value=!0,t("show"))}function J(){C.value=!1,t("close")}function Q(e){t("switch",e)}return me(()=>s.src,()=>{$.value?(v.value=!0,w.value=!1,O(),x()):I()}),ge(()=>{$.value?x():I()}),o({showPreview:j}),(e,c)=>(f(),g("div",W({ref_key:"container",ref:E},a(A),{class:[a(n).b(),e.$attrs.class]}),[w.value?y(e.$slots,"error",{key:0},()=>[M("div",{class:N(a(n).e("error"))},we(a(l)("el.image.error")),3)]):(f(),g(V,{key:1},[b.value!==void 0?(f(),g("img",W({key:0},a(_),{src:b.value,loading:e.loading,style:a(X),class:a(U),crossorigin:e.crossorigin,onClick:j,onLoad:q,onError:Y}),null,16,["src","loading","crossorigin"])):h("v-if",!0),v.value?(f(),g("div",{key:1,class:N(a(n).e("wrapper"))},[y(e.$slots,"placeholder",{},()=>[M("div",{class:N(a(n).e("placeholder"))},null,2)])],2)):h("v-if",!0)],64)),a(z)?(f(),g(V,{key:2},[C.value?(f(),ye(a(ie),{key:0,"z-index":e.zIndex,"initial-index":a(Z),infinite:e.infinite,"zoom-rate":e.zoomRate,"min-scale":e.minScale,"max-scale":e.maxScale,"show-progress":e.showProgress,"url-list":e.previewSrcList,crossorigin:e.crossorigin,"hide-on-click-modal":e.hideOnClickModal,teleported:e.previewTeleported,"close-on-press-escape":e.closeOnPressEscape,onClose:J,onSwitch:Q},he({toolbar:P(p=>[y(e.$slots,"toolbar",F(H(p)))]),default:P(()=>[e.$slots.viewer?(f(),g("div",{key:0},[y(e.$slots,"viewer")])):h("v-if",!0)]),_:2},[e.$slots.progress?{name:"progress",fn:P(p=>[y(e.$slots,"progress",F(H(p)))])}:void 0]),1032,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","show-progress","url-list","crossorigin","hide-on-click-modal","teleported","close-on-press-escape"])):h("v-if",!0)],64)):h("v-if",!0)],16))}});var $e=oe(Ae,[["__file","image.vue"]]);const Oe=de($e);export{Oe as E,xe as g};

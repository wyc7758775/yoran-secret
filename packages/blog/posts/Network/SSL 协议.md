# SSL 协议

SSL（Secure Socket Layer），由于 HTTP 协议中传输的数据是明文，所以攻击者能够毫不费力的能够拿到开发者想要保证密文的数据，SSL 就是为了解决这个问题而诞生的，它运用一定的加密解密的策略来解决攻击者获取传输过程中数据的安全。

## SSL 协议建立连接的过程

### 对称加密

对明文进行加密，让攻击者不知道它看到的数据是什么，但是同时又需要让客户端和服务端都能够解密，这样才可以进行沟通。所以对称加密就出现了，它的通过握手过程如下：

<img witdh="50%" src="https://yoran-images-1256970527.cos.ap-guangzhou.myqcloud.com/20250825155819211.png" />

1. 预主密钥的生成需要依赖于 TLS 和公开的加密算法，所以双方握手的时候需要同步 TLS 和算法的版本。
2. 密钥 = 加密 + 解密

根据这两点，也就是说攻击者拿到了预主密钥就可以直接加密和解密数据，那么这条数据传输通道将不再安全。

<img width="70%"  src="https://yoran-images-1256970527.cos.ap-guangzhou.myqcloud.com/20250825161152418.png"/>

所以这个时候就需要非对称加密了。

### 非对称加密（PKI）

它分为两个密钥，公钥和私钥

私钥只在服务端内部，中间人可以拿到公钥对数据进行加密，但是它无法使用公钥对数据进行解密。

这样子就能够解决了中间人攻击截获数据得到的真实数据。

过程如下：

![image.png｜300](https://yoran-images-1256970527.cos.ap-guangzhou.myqcloud.com/20250825170212001.png)

这个时候还有一个问题，**就是客户端没有办法判断这个公钥是不是服务端的公钥**，是不是你想要的服务端的那个公钥。中间人自己也可以生成公钥，那就意味着，中间人依旧可以截获客服端发出的信息，自己去和客户端进行沟通，获取到客户端发出的请求。

所以这个所以客户端需要判断当前的公钥是不是我们网站服务端发出的哪个公钥，这个时候就引入了一个身份认证系统，那就是证书。什么证书，它是如何解决这个问题呢？

## 证书，数字证书-Digital Certification

相当于一个网站的身份证信息。没一个证书上面都有一个指纹信息，这个信息是通过申请的证书添加的资料来生成的，是一个通过哈希函数解析出来的散列值，这个就是指纹信息。他是有一个 CA 组织发布，分配在各个国家当中。

整个过程如下：

![image.png](https://yoran-images-1256970527.cos.ap-guangzhou.myqcloud.com/20250825171609840.png)

证书市面上只有几家是可以让浏览器正确认识的，这些公司收到大家的信任，相信它们不会乱搞。

如何结合上 TCP 三次握手的话，这个过程如下：

![image.png](https://yoran-images-1256970527.cos.ap-guangzhou.myqcloud.com/20250825174317201.png)

这个过程称之为 TLS 握手。有什么面试官也会问 SSL 加密的过程是什么？也是这个。

## SSL 和 TLS 的差别

明明标题是 SSL，为什么文章内容都是 TLS？

因为 TLS 就是 SSL，等同于 SLL 3，只是改了一个名字。也可以说 TLS1.0 就等于 SSL 的 3.0。
我们现在使用 TLS 的居多, 但是平时在说 HTTPS 的时候，这个 S 一般都称呼为 SSL 是基于习惯，约定俗成。

那为什么 SSL 要改名为 TLS 呢？**完全是大公司斗争的产物**。

原文地址：https://tim.dierks.org/2014/05/security-standards-and-name-changes-in.html

简单描述如下：

1. Sll 第一个版本被网景开发出来之后，不好用，所以没有发布过。
2. 市面上第一个版本是 sll 2
3. 但是这玩意儿还是存在问题，微软先解决了，并且加入了自己的一些内容，只支持 IE 和另外一个。
4. 网景自己也想 adress 问题，所以就弄了一个 TLS 出来，不使用微软的标准和版本来解决问题

## SSL 的成本和性能

1. SSL 证书需要购买申请，功能越强大的证书费用越高
2. 根据 ACM CONEXT 数据显示，使用 HTTPS 协议会使页面的加载时间延长近 50%，增加 10%到 20%的耗电。
3. HTTPS 连接缓存不如 HTTP 高效，流量成本高。
4. HTTPS 连接服务品端资源占用高很多，支持访客多的网站需要投入更大的成本。
5. HTTPS 协议握手阶段比较费时，对网站的响应速度有影响，影响用户体验。比较好的方式是来用分而治之，类似 12306 网站的主页使用 HTTP 协议，有关于用户信息等方面使用 HTTPS.

**_上面的这些点都以及过时，在 TLS1.3 和 HTTP2/3 出来的现在，消耗的成本可以忽略不计_**
